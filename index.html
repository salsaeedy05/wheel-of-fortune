<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <title>Ø¹Ø¬Ù„Ø© Ø§Ù„Ø­Ø¸ Ù…Ø¹ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù†ØªØ§Ø¦Ø¬</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background: linear-gradient(135deg, #f8f9fa, #e0e0e0);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
      min-height: 100vh;
    }

    h2 { margin-top: 20px; font-size: 24px; color: #333; }

    .wheel-container {
      position: relative;
      width: 90vw;
      height: 90vw;
      max-width: 400px;
      max-height: 400px;
      margin-top: 20px;
    }

    .wheel {
      width: 100%;
      height: 100%;
      border-radius: 50%;
      border: 6px solid #333;
      transition: transform 4s cubic-bezier(0.33, 1, 0.68, 1);
      overflow: hidden;
      position: relative;
    }

    .wheel img {
      width: 100%;
      height: 100%;
      border-radius: 50%;
    }

    #spinBtn {
      margin-top: 25px;
      padding: 15px 30px;
      font-size: 20px;
      cursor: pointer;
      background: linear-gradient(90deg, #ff7f50, #ff6347);
      color: white;
      border: none;
      border-radius: 10px;
    }

    #spinBtn:disabled { background: #aaa; cursor: not-allowed; }

    #result { margin-top: 25px; font-size: 20px; font-weight: bold; }

    .indicator {
      position: absolute;
      top: -20px;
      left: 50%;
      transform: translateX(-50%);
      font-size: 32px;
    }
  </style>

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>

  <script>
    // Ø¥Ø¹Ø¯Ø§Ø¯ Firebase
    const firebaseConfig = {
      apiKey: "AIzaSyA8s1UtUMxUsEUgXipraHKt2TEaVZZ7eRY",
      authDomain: "wheeloffortune-a1407.firebaseapp.com",
      projectId: "wheeloffortune-a1407",
      storageBucket: "wheeloffortune-a1407.firebasestorage.app",
      messagingSenderId: "250152220914",
      appId: "1:250152220914:web:c0b007288fe4f97b54786b",
      measurementId: "G-PJNEV549NV"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();
  </script>
</head>
<body>

<h2>ğŸ¡ Ø¹Ø¬Ù„Ø© Ø§Ù„Ø­Ø¸ Ø§Ù„ÙƒØ¨ÙŠØ±Ø©</h2>

<div class="wheel-container">
  <div class="wheel" id="wheel">
    <img src="wheel-design.png" alt="Wheel">
  </div>
  <div class="indicator">â¬‡ï¸</div>
</div>

<button id="spinBtn">Ù„Ù Ø§Ù„Ø¹Ø¬Ù„Ø©</button>
<p id="result"></p>

<script>
  const prizes = [
    "ğŸ Ø®ØµÙ… 10%",
    "ğŸ‰ Ø®ØµÙ… 20%",
    "ğŸ’° Ù‚Ø³ÙŠÙ…Ø© Ø´Ø±Ø§Ø¡",
    "ğŸ˜¢ Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø¬Ø§Ø¦Ø²Ø©",
    "ğŸ Ù‡Ø¯ÙŠØ© Ù…Ø¬Ø§Ù†ÙŠØ©",
    "âœ¨ Ø¬Ø§Ø¦Ø²Ø© Ù…ÙØ§Ø¬Ø£Ø©",
    "ğŸ¯ Ù†Ù‚Ø·Ø© Ù…Ø¶Ø§Ø¹ÙØ©",
    "ğŸ’ Ø¬Ø§Ø¦Ø²Ø© Ù‚ÙŠÙ…Ø©"
  ];

  const segmentAngle = 360 / prizes.length;
  const wheel = document.getElementById("wheel");

  // ØªÙˆÙ„ÙŠØ¯ UUID Ù„ÙƒÙ„ Ù…Ø³ØªØ®Ø¯Ù…
  let userId = localStorage.getItem("userId");
  if (!userId) {
    userId = "user-" + Math.random().toString(36).substr(2, 16);
    localStorage.setItem("userId", userId);
  }

  const hasSpun = localStorage.getItem("hasSpun");
  if (hasSpun) {
    document.getElementById("spinBtn").disabled = true;
    document.getElementById("result").innerText =
      "âŒ Ù„Ù‚Ø¯ Ù‚Ù…ØªÙ Ø¨Ø§Ù„Ù„Ù Ù…Ø³Ø¨Ù‚Ù‹Ø§\nØ¬Ø§Ø¦Ø²ØªÙƒ: " + hasSpun;
  }

  document.getElementById("spinBtn").onclick = function () {
    if (localStorage.getItem("hasSpun")) return;

    const prizeIndex = Math.floor(Math.random() * prizes.length);
    const rotation = 360 * 5 + prizeIndex * segmentAngle + segmentAngle / 2;
    wheel.style.transform = `rotate(${rotation}deg)`;

    setTimeout(() => {
      const prize = prizes[prizeIndex];
      document.getElementById("result").innerText =
        "ğŸ‰ Ù…Ø¨Ø±ÙˆÙƒ! Ø¬Ø§Ø¦Ø²ØªÙƒ: " + prize;

      // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù†ØªÙŠØ¬Ø© ÙÙŠ Firebase Ù…Ø¹ Ù…Ø¹Ø±Ù Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
      db.collection("wheelResults").add({
        userId: userId,
        prize: prize,
        timestamp: new Date().toISOString()
      })
      .then(() => console.log("ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù†ØªÙŠØ¬Ø©"))
      .catch((error) => console.error("Ø®Ø·Ø£ ÙÙŠ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù†ØªÙŠØ¬Ø©: ", error));

      localStorage.setItem("hasSpun", prize);
      document.getElementById("spinBtn").disabled = true;
    }, 4000);
  };
</script>

</body>
</html>
